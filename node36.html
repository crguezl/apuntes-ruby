
<H1><A NAME="SECTION021170000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="section:accediendoatwitter"><tex2html_anchor_mark></A><BR>
Ejemplo en Ruby: Accediendo a Twitter
</H1>

<P>

<H4><A NAME="SECTION021170010000000000000">
Donde</A>
</H4>

<P>
Puede encontrar una copia de este proyecto/ejercicio en:

<UL>
<LI><PRE><tex2html_verbatim_mark>verbatim205#</PRE>
</LI>
<LI><A NAME="tex2html106"
  HREF="https://github.com/crguezl/twitter-test">https://github.com/crguezl/twitter-test</A>
</LI>
<LI><A NAME="tex2html107"
  HREF="https://bitbucket.org/casiano/twitter-test">https://bitbucket.org/casiano/twitter-test</A>
(privado)
</LI>
<LI><PRE><tex2html_verbatim_mark>verbatim206#</PRE>
</LI>
</UL>

<P>

<H4><A NAME="SECTION021170020000000000000">
README.md</A>
</H4>
<PRE><tex2html_verbatim_mark>verbatim207#</PRE>
Para saber más del formato Markdown:

<OL>
<LI><A NAME="tex2html108"
  HREF="http://daringfireball.net/projects/markdown/basics">Markdown: Basics</A>
</LI>
<LI><A NAME="tex2html109"
  HREF="http://daringfireball.net/projects/markdown/syntax">Markdown: Syntax</A>
</LI>
<LI><A NAME="tex2html110"
  HREF="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">Markdown Cheatsheet</A>
</LI>
</OL>

<P>

<H4><A NAME="SECTION021170030000000000000">
Ejecución con rvm</A>
</H4>

<P>
Usaremos Ruby Version Manager ( <A NAME="tex2html111"
  HREF="http://rvm.io/">rvm</A>
<#2444#><#2444#>) 
para gestionar las diferentes versiones del intérprete ruby que mantendremos
instaladas.
<PRE><tex2html_verbatim_mark>verbatim208#</PRE>
Vea la sección <A HREF=<tex2html_cr_mark>#chapter:rvm#2447><tex2html_cr_mark></A> para saber mas de  <A NAME="tex2html112"
  HREF="http://rvm.io/">rvm</A>
<#2448#><#2448#>.

<P>
El intérprete Ruby que estoy usando es:
<PRE><tex2html_verbatim_mark>verbatim209#</PRE>
En el directorio actual existe un fichero <tex2html_verb_mark>110<tex2html_verb_mark> que controla 
la versión de Ruby con la que trabajaré en este directorio:
<PRE><tex2html_verbatim_mark>verbatim210#</PRE>
El contenido de dicho fichero es la versión de Ruby que será usada cada vez que se entra en ese directorio:
<PRE><tex2html_verbatim_mark>verbatim211#</PRE>
Antes de ejecutar nuestro programa instalamos las librerías que son necesarias para su funcionamiento.
Las librerías en Ruby se denominan gemas:
<PRE><tex2html_verbatim_mark>verbatim212#</PRE>
Ahora podemos proceder a ejecutar el programa:
<PRE><tex2html_verbatim_mark>verbatim213#</PRE>

<P>
<tex2html_verbatim_mark>rawhtml214#

<P>

<H4><A NAME="SECTION021170040000000000000">
.ruby-version</A>
</H4>

<P>
Con este fichero determinamos con que versión del intérprete Ruby 
se trabaja en este proyecto (Véase la sección
<A HREF=<tex2html_cr_mark>#section:rvmrc#2460><tex2html_cr_mark></A>):
<PRE><tex2html_verbatim_mark>verbatim215#</PRE>

<P>

<H4><A NAME="SECTION021170050000000000000">
Gemfile</A>
</H4>

<P>
El fichero Gemfile es usado en conjunción con <A NAME="tex2html113"
  HREF="http://bundler.io//"><TT>Bundler</TT></A><#2464#><#2464#>
para informar de que librerías o gemas depende nuestra aplicación
(véase 
<A HREF=<tex2html_cr_mark>#chapter:bundler#2465><tex2html_cr_mark></A>):
<PRE><tex2html_verbatim_mark>verbatim216#</PRE>

<P>

<H4><A NAME="SECTION021170060000000000000">
Bundle</A>
</H4>

<P>
El comando <tex2html_verb_mark>111<tex2html_verb_mark> instala las gemas que figuran en el <tex2html_verb_mark>112<tex2html_verb_mark>
y sus dependencias:
<PRE><tex2html_verbatim_mark>verbatim217#</PRE>
Si <A NAME="tex2html114"
  HREF="http://bundler.io//"><TT>Bundler</TT></A><#2471#><#2471#> no esta instalado como en este ejemplo, procederemos a instalarlo
mediante el comando 
<tex2html_verb_mark>113<tex2html_verb_mark>.
(Véase la sección <A HREF=<tex2html_cr_mark>#chapter:rubygems#2472><tex2html_cr_mark></A> para saber mas):
<PRE><tex2html_verbatim_mark>verbatim218#</PRE>
Ahora si, instalamos las gemas con <tex2html_verb_mark>114<tex2html_verb_mark>
(véase <A HREF=<tex2html_cr_mark>#chapter:bundler#2475><tex2html_cr_mark></A>):
<PRE><tex2html_verbatim_mark>verbatim219#</PRE>

<P>
La opción <tex2html_verb_mark>115<tex2html_verb_mark> de <tex2html_verb_mark>116<tex2html_verb_mark> muestra todas las versiones que existen de una gema:
<PRE><tex2html_verbatim_mark>verbatim220#</PRE>

<P>

<H4><A NAME="SECTION021170070000000000000">
Véase También</A>
</H4>
Véase 

<OL>
<LI>La sección
<A HREF=<tex2html_cr_mark>#chapter:twitter#2482><tex2html_cr_mark></A>
en estos apuntes que describe la gema twitter
</LI>
<LI><A NAME="tex2html115"
  HREF="https://github.com/crguezl/twitter-test">https://github.com/crguezl/twitter-test</A>
los fuentes de este ejemplo
</LI>
<LI><A NAME="tex2html116"
  HREF="http://rdoc.info/gems/twitter">twitter gem</A>
documentación de la gema twitter
</LI>
<LI>En este enlace registramos nuestra aplicación en Twitter:
<A NAME="tex2html117"
  HREF="https://dev.twitter.com/apps/new">Register your application in twitter</A>
</LI>
<LI>Un artículo sobre como usar la gema twitter:
<A NAME="tex2html118"
  HREF="http://www.ibm.com/developerworks/library/os-dataminingrubytwitter/">Data mining with Ruby and Twitter The interesting side to a Twitter API</A>
por Tim Jones en IBM developerWorks
</LI>
<LI>Hay una versión de esta gema que provee 
un programa llamado 
<A NAME="tex2html119"
  HREF="a interface://github.com/sferik/t">t</A>
que nos da una interfaz de línea de comandos para acceder a twitter.
</LI>
<LI>Una gema relacionada:
<A NAME="tex2html120"
  HREF="https://github.com/tweetstream/tweetstream">TweetStream es una gema que proporciona acceso a la API de Twitter para streaming</A>
</LI>
</OL>

<P>

<H4><A NAME="SECTION021170080000000000000">
Estructura de la Aplicación</A>
</H4>
<PRE><tex2html_verbatim_mark>verbatim221#</PRE>

<P>

<H4><A NAME="SECTION021170090000000000000">
twitt.rb</A>
</H4>
<PRE><tex2html_verbatim_mark>verbatim222#</PRE>

<P>

<H4><A NAME="SECTION0211700100000000000000">
Autentificación con OAuth. dev.twitter.com/apps</A>
</H4>

<P>
Algunos métodos de la API de Twitter requieren que estemos autenticados (log in),
mientras que otros están disponibles sin login.
Existen dos formas de autenticarse con la API de Twitter:

<P>

<OL>
<LI>Basic HTTP authentication 
</LI>
<LI><A NAME="tex2html121"
  HREF="http://oauth.net/">OAuth</A>
</LI>
</OL>
Cuando se usa Basic HTTP authentication tenemos que preguntar al usuario 
por su username y password en Twitter. Entonces usamos el password del usuario para ejecutar
nuestra aplicación. Esto es inadecuado. Es probable que el usuario desconfíe de nuestra aplicación y 
no esté dispuesto a darle su password a la aplicación.

<P>
 <A NAME="tex2html122"
  HREF="http://oauth.net/">OAuth</A>
<#2507#><#2507#> es un protocolo que no requiere que el usuario le de a las  
aplicaciones sus passwords (de Twitter o del proveedor del servicio). 

<P>
Mediante  <A NAME="tex2html123"
  HREF="http://oauth.net/">OAuth</A>
<#2508#><#2508#> el usuario le da a tu
aplicación permiso para interactuar con su cuenta de Twitter. Twitter nos da un 
token con el que autenticarnos y nos evita tener que preguntar o que manejar las passwords
de los usuarios.

<P>
Mas formalmente, <A NAME="2669"><tex2html_anchor_invisible_mark></A><SPAN  CLASS="textit">Oauth</SPAN> es un estandard abierto para autorización.
 <A NAME="tex2html124"
  HREF="http://oauth.net/">OAuth</A>
<#2510#><#2510#> proporciona un método para que los clientes accedan a los
recursos del servidor
en nombre de un propietario del recurso
(como un usuario final).

<P>
También proporciona un proceso para los usuarios finales para autorizar
acceso a terceras partes a sus recursos en el servidor sin que haya 
necesidad de compartir credenciales (el username y password típicos),
utilizando redirecciones mediantes agentes.

<P>
En otras palabras,  <A NAME="tex2html125"
  HREF="http://oauth.net/">OAuth</A>
<#2511#><#2511#> permite a un usuario del sitio <tex2html_verb_mark>117<tex2html_verb_mark> compartir
su información en el sitio <tex2html_verb_mark>118<tex2html_verb_mark> (proveedor de servicio) con el sitio
<tex2html_verb_mark>119<tex2html_verb_mark> (llamado consumidor) sin compartir toda su identidad.

<P>
Una aplicación puede solicitar acceso de lectura o escritura a nuestra cuenta Twitter.
Cuando le damos permiso a una aplicación, la aplicación es listada en nuestro Twitter
en
<A NAME="tex2html126"
  HREF="https://twitter.com/account/connections">https://twitter.com/account/connections</A>.
En esta página tenemos la posibilidad de revocar el acceso a las aplicaciones a las que le 
hemos dado permiso en el pasado.

<P>
Para usar  <A NAME="tex2html127"
  HREF="http://oauth.net/">OAuth</A>
<#2514#><#2514#>, es necesario registrar nuestra aplicación en twitter visitando
el enlace
<A NAME="tex2html128"
  HREF="https://dev.twitter.com/apps/new">https://dev.twitter.com/apps/new</A>.

<P>
<tex2html_verbatim_mark>rawhtml223#

<P>
Una vez rellenado el formulario 
(deja vacío el campo <#2517#><I>Callback URL</I><#2517#>. Véase por ejemplo <A NAME="tex2html129"
  HREF="https://developers.google.com/accounts/docs/OAuth#tokensCallback">OAuth 1.0 for Web Applications en Google</A>)
Twitter nos asigna:

<OL>
<LI>Una clave de consumidor (consumer key)
</LI>
<LI>Un secreto de consumidor (consumer secret)
</LI>
</OL>
Estas claves son únicas a nuestra aplicación.

<P>
Otra cosa es que una vez registrada nuestra aplicación en Twitter desde una cuenta 
autorizada, el tweet contiene el nombre de nuestra aplicación y el enlace a nuestro sitio Web.

<P>
<tex2html_verbatim_mark>rawhtml224#

<P>
A continuación generamos el token y con ello 
tenemos los datos para rellenar en el bloque:

<P>
<PRE><tex2html_verbatim_mark>verbatim225#</PRE>

<P>
Véase la sección 
<A HREF=<tex2html_cr_mark>#chapter:oauth#2524><tex2html_cr_mark></A>
 <A NAME="tex2html130"
  HREF="http://oauth.net/">OAuth</A>
<#2525#><#2525#> en estos apuntes para saber mas sobre  <A NAME="tex2html131"
  HREF="http://oauth.net/">OAuth</A>
<#2526#><#2526#>.

<P>

<H4><A NAME="SECTION0211700110000000000000">
configure.rb</A>
</H4>

<P>
Copia y pega tus datos  <A NAME="tex2html132"
  HREF="http://oauth.net/">OAuth</A>
<#2528#><#2528#>:

<P>
<PRE><tex2html_verbatim_mark>verbatim226#</PRE>

<P>
