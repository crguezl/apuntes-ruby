
<H2><A NAME="SECTION028122000000000000000"><tex2html_anchor_invisible_mark></A><A NAME="10017"><tex2html_anchor_invisible_mark></A><BR>
Un DSL para Procesar Documentos XML usando <A NAME="tex2html524"
  HREF="http://ruby-doc.org/core-2.0.0/BasicObject.html#method-i-instance_eval"><TT>instance_eval</TT></A>
</H2>

<P>

<OL>
<LI>Ejemplo modificado de la sección <SPAN  CLASS="textbf">Dealing with XML</SPAN> del libro
[#ER#<tex2html_cite_mark>#1##<tex2html_cite_mark>#]. 
</LI>
<LI>Véase también 
<A NAME="tex2html525"
  HREF="https://github.com/cocoa/eloquent-ruby">https://github.com/cocoa/eloquent-ruby</A>.
</LI>
</OL>

<P>

<H4><A NAME="SECTION028122010000000000000">
XML</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
Un ejemplo de XML. Contenidos del fichero <tex2html_verb_mark>1111<tex2html_verb_mark>:
<PRE><tex2html_verbatim_mark>verbatim1103#</PRE>

<P>

<H4><A NAME="SECTION028122020000000000000">
REXML</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
Véanse:

<UL>
<LI><A NAME="tex2html526"
  HREF="http://www.germane-software.com/software/rexml/docs/tutorial.html">REXML Tutorial</A>
</LI>
<LI><A NAME="tex2html527"
  HREF="http://xml-simple.rubyforge.org/">XmlSimple - XML made easy</A>
</LI>
<LI>Veamos un ejemplo de uso de <tex2html_verb_mark>1112<tex2html_verb_mark>:
<PRE><tex2html_verbatim_mark>verbatim1104#</PRE>

<P>
Ejecución:

<P>
<PRE><tex2html_verbatim_mark>verbatim1105#</PRE>

<P>
</LI>
<LI>También podemos arreglar la errata en el nombre del autor:
<PRE><tex2html_verbatim_mark>verbatim1106#</PRE>
</LI>
</UL>

<P>

<H4><A NAME="SECTION028122030000000000000">
Un DSL para XML: Primera Versión. Modo de Uso</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>

<A NAME="parrafo:dslxmlprimeraversion"><tex2html_anchor_mark></A>
<P>
Aunque  <tex2html_verb_mark>1113<tex2html_verb_mark> es fácil de usar, nos gustaría disponer de un poco mas de expresividad de manera
que podamos expresar un conjunto de acciones
que se ejecuten cuando se produce cierto matching.
El siguiente fragmento de código muestra una primera versión de nuestro DSL:

<P>
<PRE><tex2html_verbatim_mark>verbatim1107#</PRE>

<P>

<H4><A NAME="SECTION028122040000000000000">
La Clase XmlRipper: Primera Aproximación</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
<PRE><tex2html_verbatim_mark>verbatim1108#</PRE>

<P>

<H4><A NAME="SECTION028122050000000000000">
Un DSL para XML: Segunda Versión</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
Queremos  evitar esas cacofonías de uso del objeto <tex2html_verb_mark>1114<tex2html_verb_mark>
en la versión anterior (sección <A HREF=<tex2html_cr_mark>#parrafo:dslxmlprimeraversion#9273><tex2html_cr_mark></A>) y poder usarlo así:

<P>
<PRE><tex2html_verbatim_mark>verbatim1109#</PRE>

<P>

<H4><A NAME="SECTION028122060000000000000">
Nueva versión de <TT>initialize</TT></A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
Casi lo único que hay que cambiar en la versión anterior es el método
<tex2html_verb_mark>1115<tex2html_verb_mark>:
<PRE><tex2html_verbatim_mark>verbatim1110#</PRE>

<P>
Si queremos que nuestro DSL pueda ser llamado especificando el contexto para que el bloque se ejecute
podemos usar esta versión ligeramente mas complicada:

<P>
<PRE><tex2html_verbatim_mark>verbatim1111#</PRE>

<P>

<H4><A NAME="SECTION028122070000000000000">
Un Ejecutable para Interpretar Guiones en nuestro DSL <SPAN  CLASS="textbf">XRipper</SPAN></A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
En la misma forma en que trabajan <tex2html_verb_mark>1116<tex2html_verb_mark> y <tex2html_verb_mark>1117<tex2html_verb_mark> podemos crear un ejecutable
que recibe como entrada un fichero escrito en el DSL <tex2html_verb_mark>1118<tex2html_verb_mark> y ejecuta las acciones
asociadas:

<P>
<PRE><tex2html_verbatim_mark>verbatim1112#</PRE>

<P>

<H4><A NAME="SECTION028122080000000000000">
Un Guión Escrito en Nuestro DSL <SPAN  CLASS="textbf">XRipper</SPAN> para Nuestro Intérprete <TT>xripper</TT></A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
Ahora lo único que hay que hacer es ejecutar nuestro intérprete <tex2html_verb_mark>1119<tex2html_verb_mark> sobre un fichero
escrito en el DSL:

<P>
<PRE><tex2html_verbatim_mark>verbatim1113#</PRE>

<P>

<H4><A NAME="SECTION028122090000000000000">
Ejecutando el Intérprete <SPAN  CLASS="textbf">XRipper</SPAN></A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>

Para llevar a cabo la ejecución escribimos un <tex2html_verb_mark>1120<tex2html_verb_mark>:
<PRE><tex2html_verbatim_mark>verbatim1114#</PRE>
La ejecución produce esta salida:
<PRE><tex2html_verbatim_mark>verbatim1115#</PRE>

<P>
