<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Repaso</TITLE>
<META NAME="description" CONTENT="Repaso">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node268.html">
<LINK REL="previous" HREF="node266.html">
<LINK REL="up" HREF="node224.html">
<LINK REL="next" HREF="node268.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html7272"
  HREF="node268.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html7266"
  HREF="node224.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html7260"
  HREF="node266.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html7268"
  HREF="node751.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html7270"
  HREF="node754.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://nereida.deioc.ull.es/~lpp/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="LPP"></A><A NAME="tex2html30"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1102"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html31"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1091"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html32"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html33"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html34"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html35"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html36"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html37"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html39"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html41"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html7273"
  HREF="node268.html">Repaso</A>
<B> Subir:</B> <A NAME="tex2html7267"
  HREF="node224.html">Reflexión y Metaprogramación</A>
<B> Anterior:</B> <A NAME="tex2html7261"
  HREF="node266.html">Práctica: HTML DSL con</A>
 &nbsp; <B>  <A NAME="tex2html7269"
  HREF="node751.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html7271"
  HREF="node754.html">&#205;ndice de Materias</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION028170000000000000000">
Repaso</A>
</H1>

<OL>
<LI>¿Cuanto vale <code>self</code> en las líneas 5-8 cuando <code>my_attr_reader</code> es llamado desde la línea 14?
<PRE>
MacBookdeCasiano:chapter8ReflectionandMetaprogramming casiano$ cat -n myAccessors.rb 
     1  class Module
     2    def my_attr_reader(*syms)
     3      syms.each { |s|
     4        class_eval %{
     5                      def #{s} 
     6                        @#{s} 
     7                      end
     8                    }
     9      }
    10    end
    11  end
    12  
    13  class Chuchu
    14    my_attr_reader :a, :b
    15  
    16    def initialize(a,b)
    17      @a, @b = a, b
    18    end
    19  end
</PRE>
</LI>
<LI>Rellene las partes que faltan en el código de la clase <code>Quiz</code> que implementa un DSL para la escritura de cuestionarios.
Comente el código.
<PRE>
class Quiz
  RIGHT = :right
  WRONG = :wrong

  attr_accessor :name, :_________ 

  def initialize(name, &amp;block)
    self.name = name
    self.questions = __

    @counter = 0
    _____________ &amp;block
  end

  def question(text, answers)
    q = Question.new(text, answers)
    questions &lt;&lt; q 
    @_______ = _
  end


  def to_s
    out = &lt;&lt;"EOQUIZ"
#{self.name}

#{self.questions.____("\n")}
EOQUIZ
  end

  def wrong
    @counter += 1
    [_______________]
  end

  def right
    @counter+= 1
    [_______________]
  end

  def run
    counter=0
    puts self.name+"\n\n"
    self.questions.each { |q| counter += 1 if q.ask }
    puts "#{counter} respuestas correctas de un total de #{@_________.size}."
  end
end
</PRE>
</LI>
<LI>Rellene las partes que faltan en el código de la clase <code>Question</code> 
que implementa los objetos <code>question</code> para
el DSL visto en clase para la escritura de cuestionarios. 
Comente el código.
<PRE>
class Question
  ORDER = 0
  KIND = 1
  attr_accessor :text, :answers

  def initialize(text, answers)
    @text = text
    @answers = answers.map { |k, v| _________________________________ }.sort
  end

  def to_s
    output = &lt;&lt;"EORECIPE"
#{_____}

#{
    out = ""
    @answers.each do |answer|
      out &lt;&lt; "  #{answer}\n"
    end
    ___
}
EORECIPE
  end

  def ask
    begin
      puts self
      print "Su respuesta: " 
      answerno = gets.to_i - 1
    end while (answerno &lt; 0 or answerno &gt;= @_______.______)
    @answers[________].is_right? 
  end

end
</PRE>
</LI>
<LI>Rellene las partes que faltan en el código de la clase <code>Answer</code> que implementa las respuestas
en el DSL para la escritura de cuestionarios.
Comente el código.
<PRE>
class Answer
  attr_accessor :____, :_____, :______

  def initialize(order, kind, answer)
    @kind, @order, @answer = kind, order, answer
  end

  def to_s
    "#{@order} -  #{answer}"
  end

  def is_right?
    ____________________
  end

  def ___(other)
    __________________________
  end

end
</PRE>
</LI>
<LI>Complete las partes que faltan en el siguiente código que implementa el método
<code>prun</code> de la práctica <I>Procesos Concurrentes</I>.
Comente el programa.
<PRE>
#!/usr/___/env ____ -w

def deb(m) 
  puts "#{$$}: #{m}" if $DEBUG
end


def getResult(chan)
  Marshal.____(chan.____)
end
  
def prun(p)
  pid, name, read = {}, {}, {}
  p.each { |n, code|
    read[n], write = IO.____

    pid[n] = fork do
      read[n]._____

      res = _________(n)

      write.syswrite ____________(res)

    end # fork

    write._____
  }

  name = pid.invert
  
  result = {}
  p.length.times { 
    i, s = Process._____ 
    n = _______

    result[n] = getResult(read[n])
    deb "Finished process '____' pid=____ with status #{s} result = ____________"
  }
  ______
end

res = prun(
     :one     =&gt; lambda { |n| "#{n} is 1" },
     :three   =&gt; lambda { |n| "#{n} is 3" },
     'two'    =&gt; lambda { |n| n*4 }
)
</PRE>
</LI>
<LI>Complete las partes que faltan en el siguiente código 
de la práctica <I>Ordenar por Calificaciones</I>
que implementa la ordenación de un ficheros
de notas 
con el formato:
<PRE>
Ferrer Pérez, Eduardo &amp; 9'6\\
</PRE>
Se ordenan en orden decreciente de calificaciones.
Comente el programa.
<PRE>
~/rubytesting$ cat -n calif.rb 
     1  f = File.open('notas')
     2  x = f._________
     3  
     4  y = x.map { |alu| alu =~ /_____________________/;  ________ }
     5  h =  ____[__________]
     6  h.keys.each { |alu| h[alu].gsub!(/__________)/, '_____'); h[alu] = h[alu].____ }
     7  
     8  s = h.sort { |a,b| ____ &lt;=&gt; ____ }
     9  s.each { |x| puts "_________________________" }
</PRE>

<P>
</LI>
<LI>Complete las partes que faltan en el siguiente código 
de la práctica <I>La Calculadora</I>
que implementa una calculadora extensible 
de expresiones en postfijo
que admiten variables y asignación.
Comente el programa. <PRE>
 1  class PostfixCalc
 2  
 3    attr_reader :stack
 4    attr_accessor :st
 5  
 6    def initialize(f) 
 7      @f = {
 8        '+' =&gt; lambda { |a,b| a+b },
 9        '*' =&gt; lambda { |a,b| a*b },
10        '-' =&gt; lambda { |a,b| a-b },
11        '/' =&gt; lambda { |a,b| a/b },
12        'p' =&gt; lambda { _____________ },
13        '!' =&gt; lambda { __________ },
14        '=' =&gt; lambda { _____________________ },
15      }
16      @f._____!(f)
17      @st = ________
18      @stack = __
19    end
20  
21   def eval(expr)
22      expr.gsub!(/____________________/, '\1 \2') # Se admite a= y b!
23      expr.split(/___/).each do |x|
24        case x
25          when *@f.keys
26            f = _____
27            ops = @stack.pop _______
28            b = f.call(_____)
29            @stack.push __ if __
30          when /^-?\d+(\.\d+)?$/
31            @stack.push ______
32          when /^[a-zA-Z_]\w*$/
33            _____________
34          else
35            ___________________________________________________________________       
36        end
37      end # each
38    end
39  end
..  ...
</PRE>

<P>
</LI>
<LI>Complete las partes que faltan en el siguiente fragmento de código 
que implementa la práctica <I>Conjuntos</I>
usando arrays.
Comente el programa.
<PRE>
 1  class Set2 
 2  
 3    attr_accessor :sep
 4    attr_reader :a
 5    protected :a
 6  
 7    def initialize(a)
 8      @sep = ', '
 9      @a = a.uniq.____
10    end
11  
12    def to_s
13      _______(@sep)
14    end
15  
16    def length 
17      _________
18    end
19  
20    alias cardinal ______
21  
22    def +(o)
23      Set2.new(________)
24    end
25  
26    def ^(o) # interseccion
27      Set2.new(________)
28    end
29  
30    def -(o)
31      Set2.new(________)
32    end
33  
34    def include?(x)
35      _____________
36    end
37  
38    def &lt;(s)
39      if @a.length &lt; s.a.length 
40        return true if @a.all? { |m| ______________ }
42      end
43      return false
44    end
45  
54    def ==(s)
55      _________
56    end
57  
58    def &lt;=(s)
59      _________________________
60    end
</PRE>
</LI>
<LI>¿Cual es la diferencia entre <code>dup</code> y <code>clone</code>?
</LI>
<LI>¿Cómo se llama el método que nos permite declarar
un método de clase como privado? </LI>
<LI>¿Que hace El método <A NAME="tex2html544"
  HREF="http://www.ruby-doc.org/core-1.8.7/Module.html#method-i-const_set">const_set</A>
de la clase <A NAME="tex2html545"
  HREF="http://www.ruby-doc.org/core-1.8.7/Module.html">Module</A>?
</LI>
<LI>¿Que retorna el método <code>fork</code>? ¿Que argumentos lleva?
</LI>
<LI>¿Que retorna el método <code>pipe</code>? ¿En que clase está?
</LI>
<LI>¿Que hace el método <code>wait2</code>?
</LI>
<LI>¿Que hace el método <code>exit!</code>?
</LI>
<LI>¿Que es un proceso zombi?
</LI>
<LI>¿Que diferencias hay entre <code>syswrite</code> y <code>puts</code>?
</LI>
<LI>¿Cómo funciona el método <code>popen</code>? (véase por ejemplo <A HREF="#subsection:YAML"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)
<PRE>
  popen(cmd_string, mode="r" ) {|io| block } =&gt; obj
</PRE>
</LI>
<LI>¿Que es YAML? ¿Para que sirve? (véase por ejemplo <A HREF="#subsection:YAML"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)
</LI>
<LI>¿Cual es el resultado?
<PRE>
&gt;&gt; ww ||= 8
=&gt; 
&gt;&gt; ww ||= 9
=&gt;
</PRE>
</LI>
<LI>Complete el código que falta. La clase <code>SerializableProc</code> implementa
bloques de código serializables (véase <A HREF="#Marshalling_Lambdas_y_Procs"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>):
<PRE>
class SerializableProc

   def initialize( block )
     @block = block
     @block.sub!(/^/,'lambda ') unless @block =~/^\s*(?:lambda|proc)/
     @func = eval "#{@block}"
   end


   def call(* args)
     __________(* args)
   end

   def arity
     @func.arity
   end

   def _____(limit)
     ______
   end

   def ____._____(s)
     ________(s)
   end
end
</PRE>
</LI>
<LI>¿Cuales son las salidas?
<PRE>
&gt;&gt; def tutu(n,m, &amp;b) b.call() end
=&gt; nil
&gt;&gt; tutu 2, {:a =&gt;1, :b =&gt;2} { puts "hello" }


&gt;&gt; tutu(2,{:a =&gt;1, :b =&gt;2}) { puts "hello" }
</PRE>
</LI>
<LI>¿Que hace el método <code>extend</code> cuando es llamado en un objeto?
¿Que argumentos recibe? ¿Cual es la salida de estas sentencias? (véase <A HREF="#subsection:extend"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)
<PRE>
&gt;&gt; module Chuchu
&gt;&gt; def hello; "hello" end
&gt;&gt; end
=&gt; nil
&gt;&gt; s = {}
=&gt; {}
&gt;&gt; s.extend Chuchu
=&gt; {}
&gt;&gt; s.hello
=&gt;
</PRE>
</LI>
<LI>¿Cual es el peligro de usar <code>eval</code> en un entorno distribuído?
</LI>
<LI>Comente el siguiente programa y explica su comportamiento:
<PRE>
    def multiplier(n)
      lambda do |*arr| 
                arr.collect { |i| i*n } 
             end
    end
    
    doubler = multiplier(2)
    puts doubler[1, 2, 3]
    
    eval("n = 3", doubler.binding)
    puts doubler.call(1, 2, 3)
    
    eval("n = 5", doubler)
    puts doubler.call(1, 2, 3)
</PRE>
</LI>
<LI>¿Que diferencias hay entre <A NAME="10122"></A><A NAME="tex2html546"
  HREF="http://ruby-doc.org/core-2.0.0/BasicObject.html#method-i-instance_eval"><TT>instance_eval</TT></A>, <A NAME="10126"></A><A NAME="tex2html547"
  HREF="http://ruby-doc.org/core-2.0.0/Module.html#method-i-class_eval"><TT>class_eval</TT></A>
y <code>eval</code>?
</LI>
<LI>¿Que es un DSL? ¿Que es un DSL interno o empotrado?

<P>
</LI>
</OL>
Repase los ejercicios
<A HREF="node71.html#ejercicios:schwartz">9.9</A>,
<A HREF="node68.html#ejercicios:procesos">9.8.9</A>,
<A HREF="node72.html#ejercicios:hashes">9.10</A>,
y
<A HREF="node155.html#ejercicios:lambda">12.11</A>.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html7272"
  HREF="node268.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html7266"
  HREF="node224.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html7260"
  HREF="node266.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html7268"
  HREF="node751.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html7270"
  HREF="node754.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://nereida.deioc.ull.es/~lpp/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="LPP"></A><A NAME="tex2html30"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1102"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html31"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1091"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html32"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html33"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html34"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html35"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html36"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html37"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html39"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html41"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html7273"
  HREF="node268.html">Repaso</A>
<B> Subir:</B> <A NAME="tex2html7267"
  HREF="node224.html">Reflexión y Metaprogramación</A>
<B> Anterior:</B> <A NAME="tex2html7261"
  HREF="node266.html">Práctica: HTML DSL con</A>
 &nbsp; <B>  <A NAME="tex2html7269"
  HREF="node751.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html7271"
  HREF="node754.html">&#205;ndice de Materias</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Casiano Rodriguez León
2014-09-02
</ADDRESS>
</BODY>
</HTML>
