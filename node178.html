<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Práctica: La Clase Punto del Plano</TITLE>
<META NAME="description" CONTENT="Práctica: La Clase Punto del Plano">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="previous" HREF="node177.html">
<LINK REL="up" HREF="node158.html">
<LINK REL="next" HREF="node179.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html5764"
  HREF="node179.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5758"
  HREF="node158.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5754"
  HREF="node177.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5760"
  HREF="node735.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5762"
  HREF="node738.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://nereida.deioc.ull.es/~lpp/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="LPP"></A><A NAME="tex2html30"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1102"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html31"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1091"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html32"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html33"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html34"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html35"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html36"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html37"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html39"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html41"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html5765"
  HREF="node179.html">Visibilidad de los métodos:</A>
<B> Subir:</B> <A NAME="tex2html5759"
  HREF="node158.html">Definición de una Clase</A>
<B> Anterior:</B> <A NAME="tex2html5755"
  HREF="node177.html">Variables de Instancia de</A>
 &nbsp; <B>  <A NAME="tex2html5761"
  HREF="node735.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html5763"
  HREF="node738.html">&#205;ndice de Materias</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION027120000000000000000"></A>
   <A NAME="7544"></A>
<BR>
Práctica: La Clase Punto del Plano
</H2>

<P>

<UL>
<LI>Defina una clase <code>Point</code> que represente puntos <code>(x, y)</code>del plano cartesiano.
</LI>
<LI>Defina el método <code>to_s</code>
</LI>
<LI>Defina métodos para el acceso a los atributos
</LI>
<LI>Defina la suma de puntos <!-- MATH
 $(x_1,y_1) + (x_2, y_2) = (x_1 + y_1, x_2+y_2)$
 -->
<SPAN CLASS="MATH"></SPAN>.
Compruebe que el objeto sumado hereda de la clase <code>Point</code> usando el predicado <code>is_a?</code>.
</LI>
<LI>Defina el producto de un vector/punto por un escalar <!-- MATH
 $(x,y) * \lambda = (\lambda * x, \lambda * y)$
 -->
<SPAN CLASS="MATH"></SPAN>
</LI>
<LI>Para que un entero se pueda multiplicar por un punto <code>2 * p</code> es necesario definir un método
<code>coerce</code> en la clase <code>Point</code>:
<PRE>
  def coerce(other)
    [self, other]
  end
</PRE>
Los tipos numéricos definen un método de conversión denominado <code>coerce</code>.
Cuando se llama al método <code>*</code> de <code>2</code>: <code>2*(p)</code>
este llamará primero al método <code>coerce</code> de <code>Point</code> y después 
intentará multiplicar los elementos del array retornado.
<PRE>
&gt;&gt; 1.1.coerce(1)
=&gt; [1.0, 1.1]
&gt;&gt; r = Rational(1,3)
=&gt; Rational1, 3
&gt;&gt; r.coerce(2)
=&gt; [Rational2, 1, Rational1, 3]
</PRE>
defina <code>coerce</code> de manera que pueda multiplicarse un escalar por un <code>Point</code>.
</LI>
<LI>Defina el opuesto de un punto <!-- MATH
 $-(x, y) = (-x, -y)$
 -->
<SPAN CLASS="MATH"></SPAN>.
El método para definir el menos unario se llama <code>-@</code>:
<PRE>
~/rubytesting/TheRubyProgrammingLanguage/Chapter7ClassesAndModules$ cat -n unaryminus.rb 
     1  class Tutu
     2    def initialize(s)
     3      @s = s
     4    end
     5  
     6    def -@
     7      @s.reverse
     8    end
     9  
    10    def to_s
    11      @s
    12    end
    13  end
    14  
    15  if __FILE__ == $0
    16    a = Tutu.new("dlrow olleH")
    17    puts -a
    18  end
</PRE>
Al ejecutarse produce:
<PRE>
~/rubytesting/TheRubyProgrammingLanguage/Chapter7ClassesAndModules$ ruby unaryminus.rb 
Hello world
</PRE>
</LI>
<LI>Redefine el método <code>[]</code> de manera que pueda accederse a un punto como si fuera un array
de sólo lectura.
Permite el uso de índices negativos.
También debería poder accederse usando una notación hash. Por ejemplo, el código:
<PRE>
  p = Point.new(1,2)
  puts "#{p[0]}, #{p[1]}"
  puts "#{p[-2]}, #{p[-1]}"
  puts "#{p[:x]}, #{p[:y]}"
  puts "#{p['x']}, #{p['y']}"
</PRE>
Debería producir como salida:
<PRE>
$ ruby Point.rb 
1, 2
1, 2
1, 2
1, 2
</PRE>
Un hash es una estructura de datos que asocia a cada uno de los elementos de un conjunto de objetos
denominados <I>claves</I>  un <I>valor</I>:
<PRE>
&gt;&gt; n = { :one =&gt; 1, :two =&gt; 2, :three =&gt; 3}
=&gt; {:one=&gt;1, :two=&gt;2, :three=&gt;3}
&gt;&gt; n[:four] = 4
=&gt; 4
&gt;&gt; n
=&gt; {:one=&gt;1, :two=&gt;2, :three=&gt;3, :four=&gt;4}
&gt;&gt; b = n[:one]+n[:four]
=&gt; 5
&gt;&gt; n[:five]
=&gt; nil
&gt;&gt; n.keys
=&gt; [:one, :two, :three, :four]
&gt;&gt; n.values
&gt;&gt; n.each { |k,v| puts "value for #{k} is #{v}" }
value for one is 1
value for two is 2
value for three is 3
value for four is 4
=&gt; [1, 2, 3, 4]
</PRE>
</LI>
<LI>Si queremos que los objetos de una clase 
puedan ser usados como claves de un hash es necesario que dispongan de un método <code>hash</code>
que retorne un código hash de tipo <A NAME="tex2html350"
  HREF="http://www.ruby-doc.org/core-1.8.7/classes/Fixnum.html">Fixnum</A>.
La clase <A NAME="tex2html351"
  HREF="http://www.ruby-doc.org/core-1.8.7/classes/Hash.html">Hash</A>
compara las claves 
usando el predicado <code>eql?</code>. Este predicado es similar a <code>==</code> 
pero es mas restrictivo. Por ejemplo, en las subclases de <code>Numeric</code>
<code>==</code> permite la conversión de tipos mientras que <code>eql?</code> no:
<PRE>
&gt;&gt; 1 == 1.0
=&gt; true
&gt;&gt; 1.eql?(1.0)
=&gt; false
</PRE>
Permita que los objetos <code>Point</code> puedan ser usados como índices de un hash.
El siguiente código:
<PRE>
  p = Point.new(1,2)
  q = Point.new(1,1)
  m = { p =&gt; 1, q =&gt; 2 } 
  puts m[p]
  puts m[q]
</PRE>
deberá producir como salida:
<PRE>
1
2
</PRE>
Para eso deberá definir:

<UL>
<LI>El método <code>hash</code> de un <code>Point</code>:
Puede usar con algoritmo de hashcode el descrito 
en <A NAME="tex2html352"
  HREF="http://www.linuxtopia.org/online_books/programming_books/thinking_in_java/TIJ313_029.htm">Effective Java (Addison-Wesley 2001) por Joshua Bloch </A>
</LI>
<LI>El predicado <code>eql?</code>. El predicado deberá retornar <code>true</code> si el otro objeto es exactamente de la clase
<code>Point</code>. Véase el método <code>instance_of?</code>:
<PRE>
&gt;&gt; 4.class
=&gt; Fixnum
&gt;&gt; 4.class.superclass
=&gt; Integer
&gt;&gt; 4.class.superclass.superclass
=&gt; Numeric
&gt;&gt; 4.class.superclass.superclass.superclass
=&gt; Object
&gt;&gt; 4.class.superclass.superclass.superclass.superclass
=&gt; nil
&gt;&gt; 4.instance_of? Fixnum
=&gt; true
&gt;&gt; 4.instance_of? Integer
=&gt; false
&gt;&gt; 4.instance_of? Numeric
=&gt; false
&gt;&gt; 4.is_a? Numeric
=&gt; true
</PRE>
</LI>
</UL>
</LI>
<LI>Defina un método <code>each</code> que produzca primero la primera coordenada y después la segunda.
Incluya el módulo 
<A NAME="tex2html353"
  HREF="http://www.ruby-doc.org/core/classes/Enumerable.html">Enumerable</A>
y compruebe que puede usar algunos de los métodos proveídos 
por este como <code>all?</code> y <code>any?</code>.
</LI>
<LI>Redefina el método <code>==</code> para que dos puntos sean iguales si sus coordenadas son iguales.
Siguen dos posibles implementaciones:
<TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142><PRE>
def ==(o)
  if o.is_a? Point
    @x==o.x &amp;&amp; @y==o.y
  else
    false
  end
end
</PRE></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142><PRE>
def ==(o)
  @x==o.x &amp;&amp; @y==o.y
  rescue
    false
end
</PRE></TD>
</TR>
</TABLE>
¿Sabría decir cual es la diferencia entre ambas?
</LI>
<LI>Incluya el módulo <A NAME="tex2html354"
  HREF="http://www.ruby-doc.org/core-1.8.7/classes/Comparable.html">Comparable</A>.
Defina el método <code>&lt;=&gt;</code> <I>guerra de las galaxias</I> de manera que  dos <code>Point</code> se comparan según su distancia
al origen de coordenadas.  Si <code>self</code> es menor que el objeto, <code>&lt;=&gt;</code> deberá retornar <code>-1</code>, si son iguales <code>0</code>
y <code>1</code> si es mayor.
Compruebe que puede usar los métodos proveídos por <code>Comparable</code>.

<P>
Este programa:
<PRE>
  p = Point.new(1,2)
  q = Point.new(1,1)
  r = Point.new(2,1)

  # It is not a total order relation
  puts p &gt; r 
  puts p &lt; r 
  puts p == r
  puts p &gt; q
</PRE>
Deberá producir una salida como esta:
<PRE>
false
false
false
true
</PRE>
</LI>
<LI>Incluya el módulo enumerable y compruebe que funcionan los métodos 
<code>sort</code>, <code>min</code> y <code>max</code>
</LI>
<LI>Defina una clase <code>Point3D</code> que reutilice y herede de <code>Point</code> y que tenga las mismas funcionalidades.
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html5764"
  HREF="node179.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5758"
  HREF="node158.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5754"
  HREF="node177.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5760"
  HREF="node735.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5762"
  HREF="node738.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://nereida.deioc.ull.es/~lpp/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="LPP"></A><A NAME="tex2html30"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1102"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html31"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1091"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html32"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html33"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html34"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html35"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html36"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html37"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html39"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html41"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html5765"
  HREF="node179.html">Visibilidad de los métodos:</A>
<B> Subir:</B> <A NAME="tex2html5759"
  HREF="node158.html">Definición de una Clase</A>
<B> Anterior:</B> <A NAME="tex2html5755"
  HREF="node177.html">Variables de Instancia de</A>
 &nbsp; <B>  <A NAME="tex2html5761"
  HREF="node735.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html5763"
  HREF="node738.html">&#205;ndice de Materias</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Casiano Rodriguez León
2014-09-02
</ADDRESS>
</BODY>
</HTML>
