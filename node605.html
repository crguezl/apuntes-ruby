<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>El fichero authorized_keys</TITLE>
<META NAME="description" CONTENT="El fichero authorized_keys">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node606.html">
<LINK REL="previous" HREF="node604.html">
<LINK REL="up" HREF="node601.html">
<LINK REL="next" HREF="node606.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html13389"
  HREF="node606.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html13383"
  HREF="node601.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html13377"
  HREF="node604.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html13385"
  HREF="node783.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html13387"
  HREF="node786.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://tinyurl.com/lpp1415"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html30"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5678"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html31"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html32"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html33"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html34"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html35"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html36"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html37"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html39"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html13390"
  HREF="node606.html">Deshabilitar la Asignación de</A>
<B> Subir:</B> <A NAME="tex2html13384"
  HREF="node601.html">ssh</A>
<B> Anterior:</B> <A NAME="tex2html13378"
  HREF="node604.html">Claves Pública y Privada:</A>
 &nbsp; <B>  <A NAME="tex2html13386"
  HREF="node783.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html13388"
  HREF="node786.html">&#205;ndice de Materias</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION06540000000000000000"></A>
<A NAME="subsection:authorizedkeys"></A>
<BR>
El fichero <TT>authorized_keys</TT>
</H1>

<P>
Cada línea del fichero SSH1  <TT>authorized_keys</TT>  
(habitualmente en <code>~/.ssh/authorized_keys</code>) 
contiene una clave pública. Tiene el siguiente formato:
Cada entrada va en una sóla línea. Los campos se separan por comas.
Las líneas en blanco y las que empiezan por <code>#</code> se ignoran.

<P>

<UL>
<LI>Primero van las opciones, separadas por comas, por ejemplo:

<UL>
<LI><code>from="pattern-list"</code>
El servidor <A NAME="tex2html1342"
  HREF="http://unixhelp.ed.ac.uk/CGI/man-cgi?sshd"><TT>sshd</TT></A>
puede limitar que máquinas pueden conectarse a la máquina usando wrappers TCP, pero 
no a nivel de usuario. Utilizando esta opción es posible limitar las conexiones para una identidad a un conjunto especifico
de máquinas. Los hosts se separan por comas y pueden contener comodines como <code>*</code> y <code>?</code>. Se pueden 
rechazar hosts específicos prefijándolos con <code>!</code>. Por ejemplo:

<P>
<PRE>
      from="!enemy.my_isp.net,*.my_isp.net,home.example.com"
</PRE>

<P>
</LI>
<LI><code>command="command"</code>
</LI>
<LI><code>environment="NAME=value"</code>
Se usa si se quiere tener un entorno específico cuando se usa esta clave. Por ejemplo 
podemos poner un <code>$PATH</code> restrictivo para que no pueda ejecutar ciertos comandos,
cambiar <code>$HOME</code>, etc. 

<P>
Si se tiene varias personas accediendo via diferentes identidades a la misma cuenta - 
usando tal vez un comando forzado - puede
ser útil establecer la variable <code>$LOGNAME</code> de manera que identifique quién se conecta.
</LI>
<LI><code>nopty</code>
</LI>
</UL>
Este campo es opcional. Su presencia se detecta 
viendo si la línea comienza por un número o no
</LI>
<LI>La clave pública: bits, exponente y módulo
</LI>
<LI>Un comentario (<code>user@machine.domain.es</code> en el ejemplo que sigue)
</LI>
</UL>

<P>
Sigue un ejemplo. Primero generemos una pareja especial para esto:

<P>
<PRE>
$ ssh-keygen -tdsa -C 'limited command to millo' -P '' -f ~/.ssh/limited_command
$ ssh-copy-id -i ~/.ssh/limited_command.pub millo
</PRE>
Ahora podemos entrar a la máquina usando esa pareja con:
<PRE>
$ ssh -i ~/.ssh/limited_command millo
Last login: Mon Apr 20 09:05:11 2009 from 192.168.100.242
millo:~$ vi ~/.ssh/authorized_keys
millo:~$
</PRE>
Editamos el fichero <code>~/.ssh/authorized_keys</code> y añadimos la opción comando
<PRE>
17 # Prueba de comando limitado
18 command="ls" ssh-dss AAAAB3NzaC1kc3...= limited command to millo
</PRE>

<P>
La presencia de la opción <code>command</code> permite dar acceso a nuestra cuenta a usuarios
restringiendo el uso de los comandos que pueden utilizar.
<PRE>
tonga:~/.ssh$ ssh -i ~/.ssh/limited_command millo
ADVENS_OF_SHERLOCK.html  cshrc       Imágenes  LSimple-Scope     
asignas                  Desktop     LEyapp    machines.sample  
autosave                 doc         Llhp      Makefile.PL     
bidirwithnamedpipes.pl   Documentos  LPLdoc    Música         
bin                      exrc        LPLsrc    myprofile     
cat                      help        LPL-Tutu  Net-ParSCP.tar.gz 
Connection to millo closed.
</PRE>

<P>
Es posible obtener los argumentos escritos en la línea de comandos de la llamada 
al cliente
consultando la variable de entorno <code>SSH_ORIGINAL_COMMAND</code>.
Existen otras variables de entorno que están definidas cuando
se ejecuta una conexión (véase la sección <code>ENVIRONMENT</code> en la 
página del manual de <A NAME="tex2html1343"
  HREF="http://unixhelp.ed.ac.uk/CGI/man-cgi?ssh"><TT>ssh</TT></A>)
Para ilustrar el punto usaremos el siguiente programa 
como comando forzado:
<PRE>
$ cat -n get_ssh_env
 1  #!/usr/bin/perl -w
 2  use strict;
 3
 4  my @keys = qw{
 5         SSH_ORIGINAL_COMMAND
 6         SSH_CONNECTION
 7         SSH_AUTH_SOCK
 8         SSH_TTY
 9         DISPLAY
10         HOME
11         LOGNAME
12         MAIL PATH TZ USER
13      };
14  my ($args, $con, $sock, $tty,
15      $display, $home, $logname, $mail, $path, $tz, $user
16     ) = map { $ENV{$_} || '' } @keys;
17
18  print &lt;&lt; "INFO";
19  args=&lt;$args&gt;
20  con=&lt;$con&gt;
21  sock=&lt;$sock&gt;
22  tty=&lt;$tty&gt;
23  display=&lt;$display&gt;
24  home=&lt;$home&gt;
25  logname=&lt;$logname&gt;
26  mail=&lt;$mail&gt;
27  path=&lt;$path&gt;
28  tz=&lt;$tz&gt;
29  user=&lt;$user&gt;
30  INFO
</PRE>
Cuando se fuerza en <code>authorized_keys</code> y se ejecuta la conexión
se obtiene:

<P>
<PRE>
casiano@tonga:~$ ssh -i ~/.ssh/show_arguments millo chum cham chim
args=&lt;chum cham chim&gt;
con=&lt;XXX.XXX.XXX.XXX 55286 XXX.XXX.XXX.XXX 22&gt;
sock=&lt;&gt;
tty=&lt;&gt;
display=&lt;localhost:11.0&gt;
home=&lt;/home/casiano&gt;
logname=&lt;casiano&gt;
mail=&lt;/var/mail/casiano&gt;
path=&lt;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/soft/perl5lib/bin:/home/casiano/bin&gt;
tz=&lt;&gt;
user=&lt;casiano&gt;
</PRE>

<P>
Si el administrador tiene configurada la opción <code>PermitUserEnvironment</code> de <A NAME="tex2html1344"
  HREF="http://unixhelp.ed.ac.uk/CGI/man-cgi?sshd_config"><TT>sshd_config</TT></A>
a <code>yes</code> (el valor por defecto es <code>no</code>), <A NAME="tex2html1345"
  HREF="http://unixhelp.ed.ac.uk/CGI/man-cgi?ssh"><TT>ssh</TT></A>
leerá el fichero <code>~/.ssh/environment</code> (si existe)
añadiendo al entorno líneas con el formato <code>VARNAME=value</code>.

<P>

<H4><A NAME="SECTION06540010000000000000">
Véase También</A>
</H4>
  

<P>

<UL>
<LI><A NAME="tex2html1346"
  HREF="http://www.jms1.net/ssh.shtml">http://www.jms1.net/ssh.shtml</A>
</LI>
<LI><A NAME="tex2html1347"
  HREF="http://troy.jdmz.net/rsync/index.html">http://troy.jdmz.net/rsync/index.html</A>
</LI>
<LI><A NAME="tex2html1348"
  HREF="http://www.hackinglinuxexposed.com/articles/20030109.html">http://www.hackinglinuxexposed.com/articles/20030109.html</A>
</LI>
<LI><A NAME="tex2html1349"
  HREF="http://www.snailbook.com/faq/restricted-scp.auto.html">http://www.snailbook.com/faq/restricted-scp.auto.html</A>)
</LI>
</UL>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><A NAME="tex2html13391"
  HREF="node605.html#SECTION06540010000000000000">Véase También</A>
</UL></UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html13389"
  HREF="node606.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html13383"
  HREF="node601.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html13377"
  HREF="node604.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html13385"
  HREF="node783.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html13387"
  HREF="node786.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://tinyurl.com/lpp1415"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html30"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5678"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html31"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html32"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html33"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html34"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html35"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html36"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html37"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html39"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html13390"
  HREF="node606.html">Deshabilitar la Asignación de</A>
<B> Subir:</B> <A NAME="tex2html13384"
  HREF="node601.html">ssh</A>
<B> Anterior:</B> <A NAME="tex2html13378"
  HREF="node604.html">Claves Pública y Privada:</A>
 &nbsp; <B>  <A NAME="tex2html13386"
  HREF="node783.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html13388"
  HREF="node786.html">&#205;ndice de Materias</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Casiano Rodriguez León
2014-09-29
</ADDRESS>
</BODY>
</HTML>
