
<H1><A NAME="SECTION021330000000000000000">
Exclusión Mutua y la Clase </A><A NAME="tex2html616"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A>
</H1>

<P>

<H4><A NAME="SECTION021330010000000000000">
Race Condition: definición</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
De la Wikipedia sobre <A NAME="tex2html617"
  HREF="http://en.wikipedia.org/wiki/:">Race_condition</A>
<BLOCKQUOTE>
A race condition or race hazard is the behavior of an electronic
or software system where the output is dependent on the sequence
or timing of other uncontrollable events. 
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>It becomes a bug when
events do not happen in the order the programmer intended. 
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>The term
originates with the idea of two signals racing each other to influence
the output first.

</BLOCKQUOTE>

<P>

<H4><A NAME="SECTION021330020000000000000">
Ejemplo de Race Condition</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>

<PRE><tex2html_verbatim_mark>verbatim1228#</PRE>

<P>

<H4><A NAME="SECTION021330030000000000000">
Ventajas de Usar JRuby Cuando se Usan Threads</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>

JRuby is built upon the JVM. One can make use of ;SPMquot;true;SPMquot; native threads which are able to run concurrently with your parent thread (See
<A NAME="tex2html618"
  HREF="http://www.igvita.com/2008/11/13/concurrency-is-a-myth-in-ruby/">Parallelism is a Myth in Ruby by Ilya Grigorik on November 13, 2008</A>).

<P>
A  <A NAME="11843"><tex2html_anchor_invisible_mark></A><SPAN  CLASS="textbf">Global Interpreter Lock</SPAN> (<A NAME="11845"><tex2html_anchor_invisible_mark></A><SPAN  CLASS="textbf">GIL</SPAN>) is a mutual exclusion lock held by
a programming language interpreter thread to avoid sharing code
that is not <A NAME="11847"><tex2html_anchor_invisible_mark></A><SPAN  CLASS="textbf">thread-safe</SPAN> with other threads.

<P>
Some language implementations that implement a Global Interpreter Lock are CPython, the most widely used implementation of Python, and Ruby MRI, the reference implementation of Ruby.

<P>
JVM-based equivalents of these languages (Jython and JRuby) do not use 
Global Interpreter Locks. 
JRuby is a Ruby implementation 
allowing us to natively scale our Ruby code across multiple cores. 
IronPython and IronRuby are implemented
on top of Microsoft's Dynamic Language Runtime and also avoid using
a GIL.

<P>
<tex2html_verbatim_mark>rawhtml1229#

<P>
Also, Rubinius implements native operating system threads for
concurrency and has no global interpreter lock (GIL).

<P>

<H4><A NAME="SECTION021330040000000000000">
Ejecución con JRuby</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>

<PRE><tex2html_verbatim_mark>verbatim1230#</PRE>

<P>

<H4><A NAME="SECTION021330050000000000000">
Ejecucion con ruby MRI</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>

<PRE><tex2html_verbatim_mark>verbatim1231#</PRE>

<P>

<H4><A NAME="SECTION021330060000000000000">
Mutex</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
We can use the built-in class <A NAME="tex2html619"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11713#><#11713#> to create synchronized regions—areas
of code that only one thread may enter at a time.

<P>
We resolve problems like these by using a cooperative locking
mechanism:

<OL>
<LI>Each thread that wants to access shared data must first
<tex2html_verb_mark>1300<tex2html_verb_mark> that data
</LI>
<LI>The <tex2html_verb_mark>1301<tex2html_verb_mark> is represented by a <A NAME="tex2html620"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11715#><#11715#>
(short for ;SPMquot;mutual exclusion;SPMquot;) object
</LI>
<LI>To <tex2html_verb_mark>1302<tex2html_verb_mark> a <A NAME="tex2html621"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11716#><#11716#>,
you call its <tex2html_verb_mark>1303<tex2html_verb_mark> method
</LI>
<LI>When you’re done reading or altering
the shared data, you call the <tex2html_verb_mark>1304<tex2html_verb_mark> method of the <A NAME="tex2html622"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11717#><#11717#>
</LI>
<LI><P>
The <tex2html_verb_mark>1305<tex2html_verb_mark> method blocks when called on a <A NAME="tex2html623"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11718#><#11718#> that’s
already locked, and it does not return until the caller has
successfully obtained a <tex2html_verb_mark>1306<tex2html_verb_mark>
</LI>
<LI>If each thread that accesses
the shared data locks and <tex2html_verb_mark>1307<tex2html_verb_mark>s the <A NAME="tex2html624"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11719#><#11719#> correctly,
no thread will see the data in an inconsistent state and we won’t
have problems like those we’ve described
</LI>
<LI>Instead of using the <tex2html_verb_mark>1308<tex2html_verb_mark> and <tex2html_verb_mark>1309<tex2html_verb_mark> methods explicitly, it is more common to use the <tex2html_verb_mark>1310<tex2html_verb_mark> method and associate a block with it
</LI>
<LI><tex2html_verb_mark>1311<tex2html_verb_mark> locks the <A NAME="tex2html625"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11720#><#11720#>, runs the code in the block, and then <tex2html_verb_mark>1312<tex2html_verb_mark>s the <A NAME="tex2html626"
  HREF="http://www.ruby-doc.org/core-2.0.0/Mutex.html"><TT>Mutex</TT></A><#11721#><#11721#> in an <tex2html_verb_mark>1313<tex2html_verb_mark> clause so that exceptions are properly handled
</LI>
</OL>

<P>
<PRE><tex2html_verbatim_mark>verbatim1232#</PRE>

<P>
