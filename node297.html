
<H1><A NAME="SECTION021320000000000000000">
Creación de Threads</A>
</H1>

<P>

<H4><A NAME="SECTION021320010000000000000">
new</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<OL>
<LI>Ruby makes it easy to write multi-threaded programs with the <A NAME="tex2html610"
  HREF="http://ruby-doc.org/core-2.0.0/Thread.html"><TT>Thread</TT></A><#11670#><#11670#> class
</LI>
<LI>To start a new thread, just associate a block with a call to <A NAME="tex2html611"
  HREF="http://ruby-doc.org/core-2.0.0/Thread.html"><TT>Thread</TT></A><#11671#><#11671#>.<tex2html_verb_mark>1285<tex2html_verb_mark>
</LI>
<LI>A new thread will be created to execute the code in the block, 
</LI>
<LI>the original thread will return from <A NAME="tex2html612"
  HREF="http://ruby-doc.org/core-2.0.0/Thread.html"><TT>Thread</TT></A><#11672#><#11672#>.<tex2html_verb_mark>1286<tex2html_verb_mark> immediately and resume execution with the next statement
</LI>
</OL>

<P>
<PRE><tex2html_verbatim_mark>verbatim1223#</PRE>
A ThreadError exception is raised if <tex2html_verb_mark>1287<tex2html_verb_mark> is called without a block.

<P>

<H4><A NAME="SECTION021320020000000000000">
join</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<OL>
<LI>When a thread calls <tex2html_verb_mark>1288<tex2html_verb_mark>
The calling thread 
will suspend execution and run <tex2html_verb_mark>1289<tex2html_verb_mark>. 
</LI>
<LI>The calling thread does not return until <tex2html_verb_mark>1290<tex2html_verb_mark> exits or until <tex2html_verb_mark>1291<tex2html_verb_mark> seconds have passed
if we have used <tex2html_verb_mark>1292<tex2html_verb_mark>. 
</LI>
<LI>If the time <tex2html_verb_mark>1293<tex2html_verb_mark> expires, <tex2html_verb_mark>1294<tex2html_verb_mark> will be returned, otherwise <tex2html_verb_mark>1295<tex2html_verb_mark> 
is returned.
</LI>
<LI>Any threads not joined will be killed when the main program exits. 
</LI>
<LI>If <tex2html_verb_mark>1296<tex2html_verb_mark> had previously raised an exception and the 
exception has not yet been processed, it will be processed at this time.
</LI>
</OL>
<PRE><tex2html_verbatim_mark>verbatim1224#</PRE>

<P>
<PRE><tex2html_verbatim_mark>verbatim1225#</PRE>

<P>

<H4><A NAME="SECTION021320030000000000000">
Localidad y Privacidad</A>
</H4>
  <TABLE CELLPADDING=3>
</TABLE>


<P>
A thread can normally access any variables that are in scope when
the thread is created. 

<P>
Variables local to the block containing the
thread code are local to the thread and are not shared.

<P>
Class <A NAME="tex2html613"
  HREF="http://ruby-doc.org/core-2.0.0/Thread.html"><TT>Thread</TT></A><#11684#><#11684#> features a special facility that allows thread-local variables to be created and accessed by name. 

<P>
You simply treat the thread object as if it were a <A NAME="tex2html614"
  HREF="http://ruby-doc.org/core-2.0.0/Hash.html"><TT>Hash</TT></A><#11685#><#11685#>, 
writing to elements using <tex2html_verb_mark>1297<tex2html_verb_mark> and reading them back using <tex2html_verb_mark>1298<tex2html_verb_mark>.

<P>
Veamos un ejemplo:
<PRE><tex2html_verbatim_mark>verbatim1226#</PRE>
Necesitamos la barrera proveida por 
<A NAME="tex2html615"
  HREF="http://rubydoc.info/gems/barrier/">Barrier</A>
para asegurarnos de que todas las threads han sido creadas en el momento
en el que que cada thread escribe en la variable
<tex2html_verb_mark>1299<tex2html_verb_mark>
de la thread siguiente.

<P>
La ejecución resulta en:
<PRE><tex2html_verbatim_mark>verbatim1227#</PRE>