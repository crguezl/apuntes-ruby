<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Perpetuity</TITLE>
<META NAME="description" CONTENT="Perpetuity">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node827.html">
<LINK REL="previous" HREF="node825.html">
<LINK REL="up" HREF="node648.html">
<LINK REL="next" HREF="node827.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html17476"
  HREF="node827.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html17470"
  HREF="node648.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html17464"
  HREF="node825.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html17472"
  HREF="node851.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html17474"
  HREF="node854.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://tinyurl.com/lpp1415"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html30"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5678"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html31"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html32"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html33"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html34"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html35"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html36"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html37"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html39"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html17477"
  HREF="node827.html">twitter</A>
<B> Subir:</B> <A NAME="tex2html17471"
  HREF="node648.html">HERRAMIENTAS</A>
<B> Anterior:</B> <A NAME="tex2html17465"
  HREF="node825.html">DataMapper</A>
 &nbsp; <B>  <A NAME="tex2html17473"
  HREF="node851.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html17475"
  HREF="node854.html">&#205;ndice de Materias</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION063200000000000000000">
Perpetuity</A>
</H1>
<P>
<I>Perpetuity is a simple Ruby object persistence layer that attempts to
follow Martin Fowler's Data Mapper pattern, allowing you to use plain-old
Ruby objects in your Ruby apps in order to decouple your
domain logic from the database as well as speed up your tests. 
</I>
<P>
<I>There is no need for your model classes to inherit from another class
or even include a mix-in.
</I>
<P>
<I>Your objects will hopefully eventually be able to be persisted into whichever database you like. 
</I>
<P>
<UL>
<LI><A NAME="tex2html1927"
  HREF="http://www.verious.com/code/jgaskins/perpetuity/">jgaskins / perpetuity Jamie Gaskins February 01, 2013</A>
</LI>
<LI>YouTube
<A NAME="tex2html1928"
  HREF="http://youtu.be/vlsz3W1WGVE">Perpetuity: Ruby gem for Data Mapper persistence
by Jamie Gaskins</A>
</LI>
</UL>
<P>
<H4><A NAME="SECTION063200010000000000000">
Servidor/Daemon/mongod</A>
</H4>
<P><PRE>
[~/rubytesting/perpetuity]$ mongod -vvvv
all output going to: /usr/local/var/log/mongodb/mongo.log
</PRE>
<P>
<H4><A NAME="SECTION063200020000000000000">
Gemfile</A>
</H4><PRE>
[~/rubytesting/perpetuity]$ cat Gemfile
source 'https://rubygems.org'

gem 'perpetuity-postgres'
gem 'perpetuity-mongodb', '1.0.0.beta'
</PRE>
<P>
<H4><A NAME="SECTION063200030000000000000">
Salvando Objetos</A>
</H4><PRE>
[~/rubytesting/perpetuity]$ cat app.rb 
require 'perpetuity'
require 'perpetuity/mongodb'

Perpetuity.data_source :mongodb, 'my_perpetuity_database'

#Perpetuity.configure do 
#  data_source :mongodb 
#end


class Article
  attr_accessor :title, :body
  def to_s 
    "title: #{@title}\nbody: #{body}\n"
  end
end

Perpetuity.generate_mapper_for Article do
  attribute :title
  attribute :body
end

article = Article.new
article.title = 'New Article'
article.body = 'This is an article.'

Perpetuity[Article].insert article

puts article
</PRE>
<P>
<H4><A NAME="SECTION063200040000000000000">
Recuperando Objetos</A>
</H4><PRE>
[~/rubytesting/perpetuity]$ cat app_load.rb 
require 'perpetuity'
require 'perpetuity/mongodb'
require 'pp'

Perpetuity.data_source :mongodb, 'my_perpetuity_database'

class Article
  attr_accessor :title, :body
  def to_s 
    "title: #{@title}\nbody: #{body}\n"
  end
end

Perpetuity.generate_mapper_for Article do
  attribute :title
  attribute :body
end

articles = Perpetuity[Article].all
articles.each do |article| # This is when the DB gets hit
  puts article
end
</PRE>
<P>
<H4><A NAME="SECTION063200050000000000000">
Ejecución</A>
</H4>
<P><PRE>
[~/rubytesting/perpetuity]$  ruby app_load.rb 
title: New Article
body: This is an article.
title: New Article
body: This is an article.
[~/rubytesting/perpetuity]$  ruby app.rb 
title: New Article
body: This is an article.
[~/rubytesting/perpetuity]$  ruby app_load.rb 
title: New Article
body: This is an article.
title: New Article
body: This is an article.
title: New Article
body: This is an article.
</PRE>
<P>
<H4><A NAME="SECTION063200060000000000000">
Consola mongo</A>
</H4><PRE>
[~/rubytesting/perpetuity]$ mongo
MongoDB shell version: 2.4.8
connecting to: test
Server has startup warnings: 
Sat Mar 15 14:59:07.435 [initandlisten] 
Sat Mar 15 14:59:07.435 [initandlisten] ** WARNING: soft rlimits too low. Number of files is 256, should be at least 1000
&gt; show dbs
dict_dev        0.203125GB
local   0.078125GB
my_perpetuity_database  0.203125GB
sinatra-example-dev     0.203125GB
spatialapp      0.203125GB
test    0.203125GB
&gt; use my_perpetuity_database
switched to db my_perpetuity_database
&gt; show collections
Article
system.indexes
&gt; db.Article.find()
{ "title" : "New Article", "body" : "This is an article.", "_id" : ObjectId("53246ee6a11460aefd000001") }
{ "title" : "New Article", "body" : "This is an article.", "_id" : ObjectId("532472dba114602208000001") }
{ "title" : "New Article", "body" : "This is an article.", "_id" : ObjectId("53247498a11460d527000001") }
{ "title" : "New Article", "body" : "This is an article.", "_id" : ObjectId("532476f3a114603149000001") }
{ "title" : "New Article", "body" : "This is an article.", "_id" : ObjectId("53247756a11460257d000001") }
{ "title" : "New Article", "body" : "This is an article.", "_id" : ObjectId("532480afa1146012f5000001") }
</PRE>
<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><UL>
<LI><A NAME="tex2html17478"
  HREF="node826.html#SECTION063200010000000000000">Servidor/Daemon/mongod</A>
<LI><A NAME="tex2html17479"
  HREF="node826.html#SECTION063200020000000000000">Gemfile</A>
<LI><A NAME="tex2html17480"
  HREF="node826.html#SECTION063200030000000000000">Salvando Objetos</A>
<LI><A NAME="tex2html17481"
  HREF="node826.html#SECTION063200040000000000000">Recuperando Objetos</A>
<LI><A NAME="tex2html17482"
  HREF="node826.html#SECTION063200050000000000000">Ejecución</A>
<LI><A NAME="tex2html17483"
  HREF="node826.html#SECTION063200060000000000000">Consola mongo</A>
</UL></UL></UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html17476"
  HREF="node827.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html17470"
  HREF="node648.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html17464"
  HREF="node825.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html17472"
  HREF="node851.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html17474"
  HREF="node854.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://tinyurl.com/lpp1415"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html30"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5678"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html31"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html32"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html33"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html34"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html35"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html36"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html37"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html39"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html17477"
  HREF="node827.html">twitter</A>
<B> Subir:</B> <A NAME="tex2html17471"
  HREF="node648.html">HERRAMIENTAS</A>
<B> Anterior:</B> <A NAME="tex2html17465"
  HREF="node825.html">DataMapper</A>
 &nbsp; <B>  <A NAME="tex2html17473"
  HREF="node851.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html17475"
  HREF="node854.html">&#205;ndice de Materias</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Casiano Rodriguez León
2014-12-09
</ADDRESS>
</BODY>
</HTML>
