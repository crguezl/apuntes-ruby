<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Sugerencias</TITLE>
<META NAME="description" CONTENT="Sugerencias">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="previous" HREF="node29.html">
<LINK REL="up" HREF="node29.html">
<LINK REL="next" HREF="node31.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html3333"
  HREF="node31.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html3327"
  HREF="node29.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html3323"
  HREF="node29.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html3329"
  HREF="node751.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html3331"
  HREF="node754.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://nereida.deioc.ull.es/~lpp/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="LPP"></A><A NAME="tex2html30"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1102"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html31"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1091"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html32"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html33"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html34"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html35"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html36"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html37"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html39"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html41"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html3334"
  HREF="node31.html">Práctica: Evaluar una Expresión</A>
<B> Subir:</B> <A NAME="tex2html3328"
  HREF="node29.html">Práctica: Producto y Suma</A>
<B> Anterior:</B> <A NAME="tex2html3324"
  HREF="node29.html">Práctica: Producto y Suma</A>
 &nbsp; <B>  <A NAME="tex2html3330"
  HREF="node751.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html3332"
  HREF="node754.html">&#205;ndice de Materias</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><A NAME="tex2html3335"
  HREF="node30.html#SECTION021121010000000000000">Lectura de las matrices</A>
<LI><A NAME="tex2html3336"
  HREF="node30.html#SECTION021121020000000000000">Producto</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION021121000000000000000">
Sugerencias</A>
</H2>

<P>

<OL>
<LI><A NAME="tex2html98"
  HREF="https://github.com/Lenguajes-Paradigmas-Programacion-ULL/matrix-product-functional">Repositorio privado en GitHub</A>
</LI>
</OL>

<P>

<H4><A NAME="SECTION021121010000000000000">
Lectura de las matrices</A>
</H4>
  

<P>
Supongamos este fichero de entrada:
<PRE>
[~/local/src/ruby/LPP/matrix(master)]$ cat datos.dat
1 2 3
4 5 6

1 2
3 4
5 6
</PRE>
En una primera aproximación podríamos leer el fichero siguiendo
una secuencia de comandos como esta:
<PRE>
[~/local/src/ruby/LPP/matrix(master)]$ pry
[1] pry(main)&gt; data = File.open('datos.dat').read
=&gt; "1 2 3\n4 5 6\n\n1 2\n3 4\n5 6\n"
[2] pry(main)&gt; puts data
1 2 3
4 5 6

1 2
3 4
5 6
=&gt; nil
</PRE>
La clase <A NAME="tex2html99"
  HREF="http://ruby-doc.org/core-2.0.0/File.html"><TT>File</TT></A> provee los métodos para trabajar con ficheros.
El método  <TT>read</TT>  esta definido en la clase <A NAME="tex2html100"
  HREF="http://ruby-doc.org/core-2.0.0/IO.html"><TT>IO</TT></A> de la cual <A NAME="tex2html101"
  HREF="http://ruby-doc.org/core-2.0.0/File.html"><TT>File</TT></A>
hereda.
<PRE>
[5] pry(main)&gt; File.ancestors.include? IO
=&gt; true
</PRE>
Pero claro, tenemos que a partir de la cadena <code>data</code> 
obtener las dos matrices. Podemos usar <code>split</code> para 
obtener las dos cadenas que contienen las respectivas matrices:
<PRE>
[4] pry(main)&gt; a, b = data.split(/\n\n+/)
=&gt; ["1 2 3\n4 5 6", "1 2\n3 4\n5 6\n"]
[5] pry(main)&gt; puts a
1 2 3
4 5 6
=&gt; nil
[6] pry(main)&gt; puts b
1 2
3 4
5 6
=&gt; nil
</PRE>
Pero aun queda por resolver el problema de pasar
de la cadena a la matriz.

<P>
Para hacerlo, primero escribimos una función <code>mapmap</code>
que es una extensión de <code>map</code>
para matrices:
<PRE>
def mapmap(a)
  a.map { |r| 
    r.map { |e| 
      yield e
    }
  }
end
</PRE>
Podemos usar <code>mapmap</code>  asi:
<PRE>
[~/local/src/ruby/LPP/matrix(master)]$ pry
[1] pry(main)&gt; require './matrix'
=&gt; true
[2] pry(main)&gt; a = [[1,2],[3,4]]
=&gt; [[1, 2], [3, 4]]
[3] pry(main)&gt; mapmap(a) { |x| x*x }
=&gt; [[1, 4], [9, 16]]
[4] pry(main)&gt; mapmap(a) { |x| x-1 }
=&gt; [[0, 1], [2, 3]]
[5] pry(main)&gt;
</PRE>

<P>
Ahora podemos escribir un método <code>to_m</code>
que convierte la cadena con los datos 
en una matriz:
<PRE>
def to_m(a)
  a = a.split(/\n/)
  a = a.map { |r| r.split(/\s+/) }
  a = mapmap(a) { |x| x.to_f } 
end
</PRE>

<P>
Usando <code>to_m</code> podemos construir las matrices a partir
de los datos de entrada:
<PRE>
[~/local/src/ruby/LPP/matrix(master)]$ pry
[1] pry(main)&gt; require './matrix'
=&gt; true
[2] pry(main)&gt; data = File.open('datos.dat').read 
=&gt; "1 2 3\n4 5 6\n\n1 2\n3 4\n5 6\n"
[3] pry(main)&gt; a, b = data.split(/\n\n+/)
=&gt; ["1 2 3\n4 5 6", "1 2\n3 4\n5 6\n"]
[4] pry(main)&gt; a = to_m(a)
=&gt; [[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]
[5] pry(main)&gt; a[0][0].class
=&gt; Float
</PRE>
Combinando todo lo visto, podemos escribir
el método <code>read_matrices(fn)</code> que lee el fichero de
datos y retorna las dos matrices:
<PRE>
def read_matrices(fn)
  text = File.open(fn).read

  a, b = text.split(/\n\n+/)
  a = to_m(a)
  b = to_m(b)

  [a, b]
end
</PRE>

<P>

<H4><A NAME="SECTION021121020000000000000">
Producto</A>
</H4>
  

<P>
Podemos ahora leer las matrices con <code>read_matrices</code>:
<PRE>
[~/local/src/ruby/LPP/matrix(master)]$ pry
[1] pry(main)&gt; require './matrix'
=&gt; true
[2] pry(main)&gt; a, b = read_matrices('datos.dat')
=&gt; [[[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]], [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]]
[11] pry(main)&gt; a
=&gt; [[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]
[12] pry(main)&gt; b
=&gt; [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]
</PRE>
Podemos detectar el número de filas y columnas de la matriz
así:
<PRE>
[3] pry(main)&gt; a.length
=&gt; 2
</PRE>
Supuesto que todas las filas tienen la misma longitud, el número de 
columnas viene dado por la longitud de cualquier fila:
<PRE>
[4] pry(main)&gt; a[0].length
=&gt; 3
</PRE>

<P>
Para multiplicar los elementos de
la primera fila de <code>a</code> con los
elementos de la primera columna de <code>b</code> podemos hacer:
<PRE>
[6] pry(main)&gt; z = a[0].map.with_index { |x, i| x*b[i][0] }
=&gt; [1.0, 6.0, 15.0]
</PRE>
El método  <TT>transpose</TT>  de la clase <A NAME="tex2html102"
  HREF="http://ruby-doc.org/core-2.0.0/Array.html"><TT>Array</TT></A>
da la traspuesta de una matrix:
<PRE>
[6] pry(main)&gt; bt = b.transpose
=&gt; [[1.0, 3.0, 5.0], [2.0, 4.0, 6.0]]
</PRE>
Para multiplicar los elementos de
la primera fila de <code>a</code> con los
elementos de la primera columna de <code>b</code> podemos también
hacer:
<PRE>
[8] pry(main)&gt; z = a[0].map.with_index { |x, i| x*bt[0][i] }
=&gt; [1.0, 6.0, 15.0]
</PRE>
Para multiplicar los elementos de
la primera fila de <code>a</code> con los
elementos de la segunda columna de <code>b</code> podemos hacer:
<PRE>
[9] pry(main)&gt; z = a[0].map.with_index { |x, i| x*bt[1][i] }
=&gt; [2.0, 8.0, 18.0]
</PRE>
Podemos usar el método  <TT>reduce</TT>  (tambien conocido
como  <TT>inject</TT> ) para sumar los elementos de <code>z</code>:
<PRE>
[10] pry(main)&gt; c01 = z.reduce(0) { |s, x| s+x }
=&gt; 28.0
</PRE>

<P>
Por supuesto también podemos usar bucles sobre rangos como se ilustra en este ejemplo
en el que multiplicamos la 2ª fila por la 2ª columna:
<PRE>
[10] pry(main)&gt; a
=&gt; [[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]
[11] pry(main)&gt; b
=&gt; [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]
[12] pry(main)&gt; s = 0
=&gt; 0
[17] pry(main)&gt; for k in (0...3) do s += a[1][k]*b[k][1]  end
=&gt; 0...3
[18] pry(main)&gt; s
=&gt; 64.0
</PRE>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html3333"
  HREF="node31.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html3327"
  HREF="node29.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html3323"
  HREF="node29.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html3329"
  HREF="node751.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html3331"
  HREF="node754.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://nereida.deioc.ull.es/~lpp/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="LPP"></A><A NAME="tex2html30"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1102"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html31"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1091"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html32"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html33"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html34"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html35"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html36"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html37"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html39"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html41"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html3334"
  HREF="node31.html">Práctica: Evaluar una Expresión</A>
<B> Subir:</B> <A NAME="tex2html3328"
  HREF="node29.html">Práctica: Producto y Suma</A>
<B> Anterior:</B> <A NAME="tex2html3324"
  HREF="node29.html">Práctica: Producto y Suma</A>
 &nbsp; <B>  <A NAME="tex2html3330"
  HREF="node751.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html3332"
  HREF="node754.html">&#205;ndice de Materias</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Casiano Rodriguez León
2014-09-02
</ADDRESS>
</BODY>
</HTML>
