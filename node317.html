<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Testeando una Aplicación Sinatra</TITLE>
<META NAME="description" CONTENT="Testeando una Aplicación Sinatra">
<META NAME="keywords" CONTENT="perlexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node318.html">
<LINK REL="previous" HREF="node316.html">
<LINK REL="up" HREF="node316.html">
<LINK REL="next" HREF="node318.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html8634"
  HREF="node318.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html8628"
  HREF="node316.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html8622"
  HREF="node316.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html8630"
  HREF="node858.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html8632"
  HREF="node861.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://tinyurl.com/lpp1415"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html30"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5678"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html31"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html32"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html33"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html34"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html35"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html36"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html37"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html39"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html8635"
  HREF="node318.html">Testing con Rack::Test y</A>
<B> Subir:</B> <A NAME="tex2html8629"
  HREF="node316.html">Capybara y Rack::Test</A>
<B> Anterior:</B> <A NAME="tex2html8623"
  HREF="node316.html">Capybara y Rack::Test</A>
 &nbsp; <B>  <A NAME="tex2html8631"
  HREF="node858.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html8633"
  HREF="node861.html">&#205;ndice de Materias</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><A NAME="tex2html8636"
  HREF="node317.html#SECTION021141010000000000000">app.rb</A>
<LI><A NAME="tex2html8637"
  HREF="node317.html#SECTION021141020000000000000">Entrada</A>
<LI><A NAME="tex2html8638"
  HREF="node317.html#SECTION021141030000000000000">Plantilla para el Formulario. Template: form.erb</A>
<LI><A NAME="tex2html8639"
  HREF="node317.html#SECTION021141040000000000000">Plantilla/Template con los resultados: result.erb</A>
<LI><A NAME="tex2html8640"
  HREF="node317.html#SECTION021141050000000000000">Salida</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION021141000000000000000">
Testeando una Aplicación Sinatra</A>
</H2>
Consideremos la siguiente aplicación Sinatra que permite
submitir una revisión de un libro
y que retorna los datos enviados. No se ha implementado persistencia.

<P>

<H4><A NAME="SECTION021141010000000000000">
app.rb</A>
</H4>
  

<P>
<PRE>
[~/application_testing_with_capybara/sinatra(master)]$ cat app.rb 
require 'bundler/setup'
require 'sinatra'

class BookReview &lt; Sinatra::Base

  get '/form' do
    erb :form
  end

  post '/submit' do
    @name = params[:name]
    @title = params[:title] 
    @review = params[:review]
    @age = params[:age]
    erb :result
  end

end

#only run if invoked from command line - otherwise leave to Capybara
BookReview.run! if __FILE__ == $0
</PRE>

<P>

<H4><A NAME="SECTION021141020000000000000">
Entrada</A>
</H4>
  

<P>

<img src="bookreviewssinatra.png" size="70%" />


<P>

<H4><A NAME="SECTION021141030000000000000">
Plantilla para el Formulario. Template: form.erb</A>
</H4>
  

<P>
<PRE>
[~/application_testing_with_capybara/sinatra(master)]$ cat views/form.erb 
&lt;link rel="stylesheet" href="css/form.css"&gt;
&lt;form action="/submit" method="post"&gt;
  &lt;header id="header" class="info"&gt;
    &lt;h2&gt;Book Reviews&lt;/h2&gt;
    &lt;div&gt;Review the last book you purchased...&lt;/div&gt;
  &lt;/header&gt;
  &lt;ul&gt;
    &lt;li&gt;
    &lt;label for="name"&gt;
      Your Name
    &lt;/label&gt;
    &lt;input type="text" id="name" name="name" maxlegth="255"&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;label class="desc" for="age"&gt;
      Age Range
    &lt;/label&gt;
    &lt;div&gt;
      &lt;select id="age" name="age"&gt; 
        &lt;option value="-" selected="selected"&gt;
        &lt;/option&gt;
        &lt;option value="&lt;20" &gt;
        Under 20
        &lt;/option&gt;
        &lt;option value="20-50" &gt;
        20 - 50 
        &lt;/option&gt;
        &lt;option value="50+" &gt;
        Over 50
        &lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;label for="book_title"&gt;
      Book Title
    &lt;/label&gt;
    &lt;input type="text" id="book_title" name="title" maxlegth="255"&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;label for="review"&gt;
      Your Review...
    &lt;/label&gt;
    &lt;textarea id="review" name="review" rows="10" cols="50"&gt;&lt;/textarea&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;input type="submit" value="Submit"/&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/form&gt;
</PRE>

<P>

<H4><A NAME="SECTION021141040000000000000">
Plantilla/Template con los resultados: result.erb</A>
</H4>
  

Hay otro template ERB utilizado para mostrar la revisión:
<PRE>
[~/application_testing_with_capybara/sinatra(master)]$ cat views/result.erb 
&lt;div class="saved_review"&gt;
&lt;p&gt;You submitted the following on: &lt;%= Time.new.strftime("%Y-%m-%d %H:%M:%S") %&gt; &lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;
    &lt;p id="name"&gt;Name: &lt;%= @name %&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;p id="age"&gt;Age: &lt;%= @age %&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;p id="title"&gt;Book Title: &lt;%= @title %&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
    &lt;p id="review"&gt;Book Review: &lt;%= @review %&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;a href="/form"&gt;Submit another review...&lt;/a&gt;
&lt;/div&gt;
</PRE>

<P>

<H4><A NAME="SECTION021141050000000000000">
Salida</A>
</H4>
  

<P>

<img src="subimttedreview.png" size="70%" />


<P>
Veamos ahora como hacer las pruebas para esta aplicación usando 
Capybara.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html8634"
  HREF="node318.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html8628"
  HREF="node316.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html8622"
  HREF="node316.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html8630"
  HREF="node858.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html8632"
  HREF="node861.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html29"
  HREF="http://tinyurl.com/lpp1415"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="LPP moodle"></A><A NAME="tex2html30"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5678"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="SYTW moodle"></A><A NAME="tex2html31"
  HREF="perlexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="pdf"></A><A NAME="tex2html32"
  HREF="https://dl.dropbox.com/u/14539152/LPP/LPPbook/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html33"
  HREF="http://www.ruby-doc.org/"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html34"
  HREF="http://www.github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html35"
  HREF="http://rubylearning.com/blog/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html36"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html37"
  HREF="http://www.ull.es/view/centros/etsii/Inicio/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html38"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html39"
  HREF="https://plus.google.com/u/0/communities/115470806071217401678"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-lpp-1314"></A><A NAME="tex2html40"
  HREF="https://plus.google.com/u/0/communities/109091480492072495700"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="ull-etsii-grado-stw-1314"></A>
<BR>
<B> Siguiente:</B> <A NAME="tex2html8635"
  HREF="node318.html">Testing con Rack::Test y</A>
<B> Subir:</B> <A NAME="tex2html8629"
  HREF="node316.html">Capybara y Rack::Test</A>
<B> Anterior:</B> <A NAME="tex2html8623"
  HREF="node316.html">Capybara y Rack::Test</A>
 &nbsp; <B>  <A NAME="tex2html8631"
  HREF="node858.html">&#205;ndice General</A></B> 
 &nbsp; <B>  <A NAME="tex2html8633"
  HREF="node861.html">&#205;ndice de Materias</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Casiano Rodriguez León
2015-01-07
</ADDRESS>
</BODY>
</HTML>
